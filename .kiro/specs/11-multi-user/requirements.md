# 多用户 SaaS 系统 - 需求文档

## 业务需求

### 用户故事

1. **作为用户**，我希望注册账户并绑定我的 Binance API Key，以便使用平台的自动交易服务
2. **作为用户**，我希望查看我的仓位、订单和收益，以便了解交易情况
3. **作为用户**，我希望我的资金和数据与其他用户完全隔离，以保证安全
4. **作为管理员**，我希望查看所有用户状态和平台收益，以便运营管理

### 功能需求

#### FR-1: 用户管理
- FR-1.1: 用户可通过邮箱注册账户
- FR-1.2: 用户可登录/登出系统
- FR-1.3: 用户可修改密码
- FR-1.4: 管理员可暂停/激活用户

#### FR-2: 交易所配置
- FR-2.1: 用户可绑定 Binance API Key
- FR-2.2: 系统验证 API Key 有效性
- FR-2.3: 用户可配置杠杆和最大仓位
- FR-2.4: 用户可删除 API Key 配置

#### FR-3: 交易执行
- FR-3.1: 系统产出的交易信号广播给所有活跃用户
- FR-3.2: 每个用户独立执行交易
- FR-3.3: 每个用户有独立的风控状态
- FR-3.4: 单用户执行失败不影响其他用户

#### FR-4: 数据查询
- FR-4.1: 用户可查看自己的仓位
- FR-4.2: 用户可查看自己的订单和成交
- FR-4.3: 用户可查看自己的收益统计
- FR-4.4: 用户只能访问自己的数据

#### FR-5: 计费
- FR-5.1: 系统按日计算用户收益
- FR-5.2: 盈利时收取平台分成
- FR-5.3: 不同订阅计划有不同分成比例
- FR-5.4: 用户可查看费用明细

### 非功能需求

#### NFR-1: 安全性
- NFR-1.1: API Key 必须加密存储（AES-256）
- NFR-1.2: 密码必须哈希存储（bcrypt）
- NFR-1.3: API 必须使用 JWT 认证
- NFR-1.4: 用户数据必须严格隔离

#### NFR-2: 性能
- NFR-2.1: 支持 100 用户同时在线
- NFR-2.2: 信号广播延迟 < 1 秒
- NFR-2.3: 单用户执行超时不阻塞其他用户

#### NFR-3: 可用性
- NFR-3.1: API Key 失效时通知用户
- NFR-3.2: 用户风控锁定时通知用户
- NFR-3.3: 提供清晰的错误信息

## 约束条件

1. 用户数量 ≤ 100
2. 所有用户共享同一套策略
3. 用户自己提供 Binance API Key
4. 仅支持 Binance Futures

## 验收标准

1. 用户可完成注册、登录、绑定 API Key 全流程
2. 交易信号可并行分发给所有活跃用户
3. 每个用户有独立的风控状态和执行结果
4. 用户只能查看自己的数据
5. 收益和费用计算准确
6. API Key 加密存储，无法明文读取
