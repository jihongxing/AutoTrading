# 文档 2：BTC 自动交易系统 — 策略编排与中间抽象层 PRD

> **核心认知**：在高效市场中，不存在"强信号"。系统价值在于组合多个弱信号（胜率 52-55%），通过证人体系和严格风控实现长期稳定盈利。

## 一、文档目标

定义全局状态机与具体交易执行之间的中间抽象层，将多个弱信号证人映射为统一、稳定、可扩展的交易范式输出。

## 二、设计原则（基于弱信号组合哲学）

1. **接受弱信号**：单个证人胜率 52-55% 即为有效，不追求 > 60%
    
2. **组合优于单一**：多个弱信号组合可提升整体胜率至 58-62%
    
3. **证人独立性**：每个证人提供独立视角，降低相关性
    
4. **范式稳定性**：范式数量远小于证人数量，保持系统稳定
    
5. **输出可解释**：每个决策可追溯到具体证人组合
    

## 三、系统定位

Eligibility Strategies → Strategy Orchestrator（本层） → Global State Machine

- 不直接参与下单或感知仓位资金。
    

## 四、核心概念（基于弱信号组合）

- **弱信号证人（Weak Signal Witness）**：
  - 单个证人胜率 52-55%（TIER 1）或 51-53%（TIER 2）
  - 提供独立市场视角，不追求单一强信号
  - 输出：是否值得交易 + 置信度 + 时间窗口
    
- **Trade Regime**：
  - 描述市场可利用结构状态，非交易方法
  - 包含允许结构类型、禁止行为、推荐持仓时间和风险形态
  - 由多个弱信号证人组合决定
    

## 五、弱信号组合编排机制

- **输入**：多个弱信号证人输出（每个胜率 52-55%）
    
- **决策机制**：
  - 加权投票：核心证人（TIER 1）高权重，辅助证人（TIER 2）低权重
  - 组合增强：3-5 个证人同时发声 → 整体胜率提升至 58-62%
  - 置信度阈值：单个证人置信度不足时，需要更多证人支持
  - 冲突消解：证人意见分歧时，优先采纳核心证人意见
    
- **核心价值**：
  - 单个弱信号不可靠 → 组合后可靠
  - 降低单一策略失效风险
  - 通过大样本累积实现长期优势
    

## 六、映射规则

- 资格策略映射为 Trade Regime，不直接绑定执行逻辑。
    
- 示例：波动率压缩 + 时间窗口 → VOLATILITY_EXPANSION；区间成交失效 → RANGE_STRUCTURE_BREAK；止损密集区异常 → LIQUIDITY_SWEEP。
    

## 七、输出规范

- 输出结构：trade_regime、confidence、expected_duration、risk_hint。
    
- 输出直接供全局状态机使用。
    

## 八、扩展性设计

- 新增资格策略无需修改状态机。
    
- 新增执行策略仅需声明支持的 Trade Regime。
    
- AI 可在同一范式内学习最优执行模板。
    

## 九、失败与退化机制

- 策略冲突 → NO_DECISION。
    
- 置信度不足 → 回退 WATCHING。
    
- 策略健康度下降 → 自动降权。
    

## 十、成功判定标准

- 策略数量增长不引发复杂度爆炸。
    
- Trade Regime 种类保持稳定。
    
- 执行层可独立演化不影响资格层。

## 十一、策略开发优先级路线图

Phase 1（必做）
1. 波动率释放 + 时间衰减
2. 区间破坏（结构级）

Phase 2（增强）
3. 时间结构优势（辅助）
4. 波动率不对称（增强）

Phase 3（进阶）
5. 流动性收割窗口
6. 微结构异常（加权）

Phase 4（宏观）
7. **增加辅助风控证人**
    
    - 风控证人独立于盈利策略
        
    - 负责仓位限制、最大回撤、波动过大时冻结信号
        
8. **宏观/事件证人**
    
    - 监控重大新闻、政策、稳定币流动性
        
    - 在极端市场环境下提供“否决权”
        
9. **证人分级与权重调整**
    
    - 核心证人（1、2） → 高发言权
        
    - 辅助增强证人（3、4、5、6） → 提供权重加分或否决信号
        
    - 风控/宏观证人 → 硬否决或冻结权
        

> 理想状态：6 个盈利证人 + 2~3 个风控/宏观证人 → 总证人数量控制在 8~9 个 → 保证信息覆盖和稳定性，同时交易频率不被过度削减。

用途：

- 指导研发团队按优先级开发资格策略
- 帮助 AI 或系统迭代学习时区分基础/增强/进阶策略
- 不影响全局状态机设计边界
- 风控/宏观证人独立于盈利策略，确保系统安全
- 只提供“硬否决”或冻结权，不直接产生盈利信号
- 保持原有 6 个盈利证人的决策流程不变，只在必要时介入

## 十二、《BTC 自动交易系统 — 证人扩展 PRD（风控/宏观证人）》文字版示例

### 1️⃣ 目的

引入 2~3 个独立证人，专注**风险控制和宏观事件监控**，保障大资金低频交易的长期稳定性，确保：

- 避免爆仓
    
- 防止极端市场事件导致不可控亏损
    
- 提供硬否决或冻结交易权
    

---

### 2️⃣ 风控证人（Risk Sentinel）

|属性|描述|
|---|---|
|**类型**|风控 / 系统安全|
|**主要功能**|- 仓位上限监控  <br>- 最大回撤监控  <br>- 高波动冻结交易信号|
|**输入**|当前系统仓位、未平订单、历史回撤数据、波动指标|
|**输出**|交易信号冻结（硬否决）或仓位调整建议|
|**发言权**|硬否决 / 冻结权：任何策略信号在风险超限时必须停手|
|**触发条件**|- 仓位超限  <br>- 单笔或总回撤超过阈值  <br>- 15分钟波动率超过设定阈值|

---

### 3️⃣ 宏观 / 事件证人（Macro/Event Sentinel）

|属性|描述|
|---|---|
|**类型**|宏观 / 事件监控|
|**主要功能**|- 重大新闻、政策监控  <br>- 稳定币或流动性异常监控  <br>- 极端市场事件预警|
|**输入**|新闻推送、政策公告、稳定币储备或交易所流动性数据|
|**输出**|硬否决信号（冻结交易）、风险提示|
|**发言权**|硬否决 / 冻结权：策略信号在极端事件下不可执行|
|**触发条件**|- 政策或交易所公告可能影响 BTC 流动性  <br>- 稳定币流动性异常  <br>- 极端价格快速波动|

---

### 4️⃣ 证人分级与权重

|证人类型|核心发言 / 权重|备注|
|---|---|---|
|核心盈利证人（1、2）|高发言权|决定主要交易信号方向|
|辅助增强证人（3、4、5、6）|权重加分 / 可否决|对信号提供优化或辅助否决|
|风控/宏观证人|硬否决 / 冻结权|超限或极端事件立即阻止交易|

---

### 5️⃣ 系统行为示意（文字版）

```text
交易策略证人发出信号 → 裁决层整合 → 风控/宏观证人检查
    ↓
如风险正常 → 执行交易
如触发硬否决 → RISK_LOCKED / 信号冻结 → 系统等待恢复

```


## 十三、高交易窗口判定文字版流程示意

```text
┌─────────────────────────────┐
│ 1. 策略层 / 策略编排 PRD    │
│ 高交易窗口判定逻辑所在位置   │
│ 输入：                        │
│ - 核心证人信号（波动率释放+区间破坏） │
│ - 辅助证人信号（时间结构优势、微结构异常等） │
│ - 当前市场行情（价格、成交量、波动率、深度） │
│ 输出：                        │
│ - 是否属于高交易窗口           │
│ - 建议仓位放大系数             │
└───────────────┬─────────────┘
                │
                ▼
┌─────────────────────────────┐
│ 2. 执行层 / 执行层 PRD        │
│ 输入：                        │
│ - 高交易窗口判定结果           │
│ - 建议仓位放大系数             │
│ 输出：                        │
│ - 实际下单仓位调整             │
│ - 动态止盈止损放大/缩减        │
└───────────────┬─────────────┘
                │
                ▼
┌─────────────────────────────┐
│ 3. 自学习 / 自学习自优化 PRD  │
│ 输入：                        │
│ - 历史交易数据（信号、执行结果、盈亏） │
│ - 高交易窗口判定记录           │
│ 输出：                        │
│ - 优化高交易窗口判定阈值        │
│ - 调整信号权重与窗口评分方法    │
│ - 建议调整放大系数或冻结窗口    │
└───────────────┘

说明：
1. 高交易窗口判定逻辑属于策略层，但其输出影响执行层的仓位和止盈止损策略。
2. 自学习模块周期性优化高交易窗口判定规则和阈值。
3. 执行层只使用窗口输出，不参与判定逻辑本身。
4. 形成完整闭环：
   策略层判定 → 执行层应用 → 自学习反馈 → 策略层优化

```
